<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Claude Code — cruciblecanvas tracking</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
          background: #0f1117; color: #e2e8f0; padding: 24px; }
  h1 { font-size: 1.25rem; font-weight: 600; margin-bottom: 4px; color: #f8fafc; }
  .subtitle { font-size: 0.8rem; color: #64748b; margin-bottom: 24px; }
  .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
             gap: 12px; margin-bottom: 28px; }
  .stat { background: #1e2330; border: 1px solid #2d3748; border-radius: 10px;
           padding: 14px 16px; }
  .stat-label { font-size: 0.7rem; color: #64748b; text-transform: uppercase;
                  letter-spacing: 0.05em; margin-bottom: 4px; }
  .stat-value { font-size: 1.4rem; font-weight: 700; color: #f8fafc; }
  .stat-sub { font-size: 0.7rem; color: #94a3b8; margin-top: 2px; }
  .section { margin-bottom: 36px; }
  .section-header { font-size: 0.75rem; font-weight: 600; color: #64748b;
                     text-transform: uppercase; letter-spacing: 0.08em;
                     padding: 0 0 10px 12px; margin-bottom: 16px;
                     border-bottom: 1px solid #2d3748; }
  .section-header.cost  { border-left: 3px solid #6366f1; color: #818cf8; }
  .section-header.time  { border-left: 3px solid #34d399; color: #34d399; }
  .section-header.prompts { border-left: 3px solid #a78bfa; color: #a78bfa; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
  .card { background: #1e2330; border: 1px solid #2d3748; border-radius: 10px;
           padding: 16px; }
  .card.wide { grid-column: 1 / -1; }
  .card h2 { font-size: 0.78rem; font-weight: 600; color: #94a3b8;
               text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 14px; }
  canvas { max-height: 240px; }
  .wide canvas { max-height: 200px; }
  .notice { font-size: 0.78rem; color: #94a3b8; background: #1e2330;
             border: 1px solid #3b4a6b; border-left: 3px solid #6366f1;
             border-radius: 6px; padding: 10px 14px; margin-bottom: 20px; }
  .notice strong { color: #e2e8f0; }
  @media (max-width: 700px) { .grid { grid-template-columns: 1fr; } }
</style>
</head>
<body>
<h1>Claude Code — cruciblecanvas</h1>
<p class="subtitle">Updated after every session &mdash; open in browser to view</p>
<p class="notice">&#9432; Cost figures are <strong>API list-price equivalents</strong> (what pay-as-you-go API customers would be charged). If you are on a Max subscription, these are <em>not</em> amounts billed to you.</p>

<div class="stats">
  <div class="stat">
    <div class="stat-label">API list-price equivalent</div>
    <div class="stat-value">$16.64</div>
    <div class="stat-sub">across 2 days (not billed)</div>
  </div>
  <div class="stat">
    <div class="stat-label">Sessions</div>
    <div class="stat-value">2</div>
    <div class="stat-sub">2 with token data</div>
  </div>
  <div class="stat">
    <div class="stat-label">Output tokens</div>
    <div class="stat-value">64,319</div>
    <div class="stat-sub">&nbsp;</div>
  </div>
  <div class="stat">
    <div class="stat-label">Cache read share</div>
    <div class="stat-value">97.6%</div>
    <div class="stat-sub">of all tokens</div>
  </div>
  <div class="stat">
    <div class="stat-label">Session time</div>
    <div class="stat-value">24m 17s</div>
    <div class="stat-sub">avg 12m 8s / session</div>
  </div>
  <div class="stat">
    <div class="stat-label">Key prompts captured</div>
    <div class="stat-value">0</div>
    <div class="stat-sub">of 0 total prompts</div>
  </div>
  <div class="stat">
    <div class="stat-label">Prompt efficiency</div>
    <div class="stat-value">0%</div>
    <div class="stat-sub">key / non-trivial (higher = better)</div>
  </div>
</div>

<div class="section">
  <div class="section-header cost">Cost &amp; Usage</div>
  <div class="grid">

    <div class="card wide">
      <h2>Cumulative cost</h2>
      <canvas id="cumul"></canvas>
    </div>

    <div class="card">
      <h2>Cost per day</h2>
      <canvas id="costDay"></canvas>
    </div>

    <div class="card">
      <h2>Sessions per day</h2>
      <canvas id="sessDay"></canvas>
    </div>

    <div class="card wide">
      <h2>Cost by model</h2>
      <canvas id="modelStack"></canvas>
    </div>

  </div>
</div>

<div class="section">
  <div class="section-header prompts">Key Prompts</div>
  <div class="grid">

    <div class="card wide">
      <h2>Prompts per day</h2>
      <canvas id="promptsVsTotal"></canvas>
    </div>

    <div class="card">
      <h2>Efficiency per day (%)</h2>
      <canvas id="promptEfficiency"></canvas>
    </div>

    <div class="card">
      <h2>Category breakdown</h2>
      <canvas id="promptDonut"></canvas>
    </div>

    <div class="card wide">
      <h2>Categories per day</h2>
      <canvas id="promptStack"></canvas>
    </div>

  </div>
</div>

<div class="section">
  <div class="section-header time">Time</div>
  <div class="grid">

    <div class="card">
      <h2>Duration per day</h2>
      <canvas id="durationDay"></canvas>
    </div>

    <div class="card">
      <h2>Avg duration per day</h2>
      <canvas id="avgDurationDay"></canvas>
    </div>

    <div class="card">
      <h2>Tokens per minute</h2>
      <canvas id="tokensPerMin"></canvas>
    </div>

    <div class="card">
      <h2>Session length distribution</h2>
      <canvas id="durationDist"></canvas>
    </div>

    <div class="card wide">
      <h2>Cumulative time</h2>
      <canvas id="cumulTime"></canvas>
    </div>

    <div class="card wide">
      <h2>Time vs cost</h2>
      <canvas id="timeVsCost"></canvas>
    </div>

  </div>
</div>

<script>
const DATES = ["2026-02-19", "2026-02-20"];
const COST_BY_DATE = [3.9763, 12.6626];
const SESSIONS_BY_DATE = [1, 1];
const OUTPUT_BY_DATE = [7505, 56814];
const OPUS_BY_DATE = [0, 0];
const SONNET_BY_DATE = [3.9763, 12.6626];
const CUMUL_LABELS = ["2026-02-19 #1", "2026-02-20 #2"];
const CUMUL_VALUES = [3.9763, 16.6389];
const MODEL_LABELS = ["claude-sonnet-4-6"];
const MODEL_COSTS = [16.6389];
const MODEL_SESSIONS = [2];
const PROMPT_DATES = [];
const PROMPT_TOTALS = [];
const PROMPT_CAT_DATASETS = [];
const DONUT_LABELS = [];
const DONUT_VALUES = [];
const DONUT_COLORS = [];
const ALL_PROMPT_DATES = [];
const TOTAL_MSGS_BY_DATE = [];
const TRIVIAL_BY_DATE = [];
const KEY_PROMPTS_BY_DATE = [];
const EFFICIENCY_BY_DATE = [];
const DURATION_BY_DATE = [394, 1063];
const CUMUL_DURATION = [394, 1457];
const AVG_DURATION_BY_DATE = [394, 1063];
const SCATTER_DATA = [{"x": 394, "y": 3.9763, "label": "2026-02-19 3c7323"}, {"x": 1063, "y": 12.6626, "label": "2026-02-20 e71684"}];
const TPM_DATA = [{"x": 394, "y": 1142.9, "label": "2026-02-19 3c7323"}, {"x": 1063, "y": 3206.8, "label": "2026-02-20 e71684"}];
const DUR_HIST_LABELS = ["0\u20132m", "2\u20135m", "5\u201315m", "15\u201330m", "30m+"];
const DUR_HIST_VALUES = [0, 0, 1, 1, 0];

function formatDuration(s) {
  if (s <= 0) return '0s';
  const h = Math.floor(s / 3600);
  const m = Math.floor((s % 3600) / 60);
  const sec = Math.round(s % 60);
  if (h > 0) return h + 'h ' + m + 'm';
  if (m > 0) return m + 'm' + (sec > 0 ? ' ' + sec + 's' : '');
  return sec + 's';
}

const GRID = '#2d3748';
const TEXT = '#94a3b8';
const baseOpts = {
  responsive: true,
  maintainAspectRatio: true,
  plugins: { legend: { labels: { color: TEXT, boxWidth: 12, font: { size: 11 } } } },
  scales: {
    x: { ticks: { color: TEXT, font: { size: 10 } }, grid: { color: GRID } },
    y: { ticks: { color: TEXT, font: { size: 10 } }, grid: { color: GRID } }
  }
};

// Cumulative cost line
new Chart(document.getElementById('cumul'), {
  type: 'line',
  data: {
    labels: CUMUL_LABELS,
    datasets: [{ label: 'Cumulative cost ($)', data: CUMUL_VALUES,
      borderColor: '#6366f1', backgroundColor: 'rgba(99,102,241,0.15)',
      fill: true, tension: 0.3, pointRadius: 2 }]
  },
  options: { ...baseOpts, plugins: { ...baseOpts.plugins,
    tooltip: { callbacks: { label: ctx => ' $' + ctx.parsed.y.toFixed(2) } } } }
});

// Cost per day bar
new Chart(document.getElementById('costDay'), {
  type: 'bar',
  data: {
    labels: DATES,
    datasets: [{ label: 'Cost ($)', data: COST_BY_DATE,
      backgroundColor: '#6366f1', borderRadius: 4 }]
  },
  options: { ...baseOpts, plugins: { ...baseOpts.plugins,
    tooltip: { callbacks: { label: ctx => ' $' + ctx.parsed.y.toFixed(2) } } } }
});

// Sessions per day
new Chart(document.getElementById('sessDay'), {
  type: 'bar',
  data: {
    labels: DATES,
    datasets: [{ label: 'Sessions', data: SESSIONS_BY_DATE,
      backgroundColor: '#22d3ee', borderRadius: 4 }]
  },
  options: baseOpts
});

// Model stacked per day
new Chart(document.getElementById('modelStack'), {
  type: 'bar',
  data: {
    labels: DATES,
    datasets: [
      { label: 'Opus', data: OPUS_BY_DATE, backgroundColor: '#f59e0b', borderRadius: 2 },
      { label: 'Sonnet', data: SONNET_BY_DATE, backgroundColor: '#6366f1', borderRadius: 2 }
    ]
  },
  options: { ...baseOpts, scales: { ...baseOpts.scales, x: { ...baseOpts.scales.x, stacked: true },
    y: { ...baseOpts.scales.y, stacked: true } },
    plugins: { ...baseOpts.plugins,
      tooltip: { callbacks: { label: ctx => ' $' + ctx.parsed.y.toFixed(2) } } } }
});

// Session duration per day
new Chart(document.getElementById('durationDay'), {
  type: 'bar',
  data: {
    labels: DATES,
    datasets: [{ label: 'Duration', data: DURATION_BY_DATE,
      backgroundColor: '#f59e0b', borderRadius: 4 }]
  },
  options: { ...baseOpts,
    scales: { ...baseOpts.scales,
      y: { ...baseOpts.scales.y,
        ticks: { ...baseOpts.scales.y.ticks, callback: v => formatDuration(v) } } },
    plugins: { ...baseOpts.plugins,
      tooltip: { callbacks: { label: ctx => ' ' + formatDuration(ctx.parsed.y) } } } }
});

// Avg session duration per day
new Chart(document.getElementById('avgDurationDay'), {
  type: 'line',
  data: {
    labels: DATES,
    datasets: [{ label: 'Avg duration', data: AVG_DURATION_BY_DATE,
      borderColor: '#a78bfa', backgroundColor: 'rgba(167,139,250,0.15)',
      fill: true, tension: 0.3, pointRadius: 3 }]
  },
  options: { ...baseOpts,
    scales: { ...baseOpts.scales,
      y: { ...baseOpts.scales.y,
        ticks: { ...baseOpts.scales.y.ticks, callback: v => formatDuration(v) } } },
    plugins: { ...baseOpts.plugins,
      tooltip: { callbacks: { label: ctx => ' ' + formatDuration(ctx.parsed.y) } } } }
});

// Cumulative time line
new Chart(document.getElementById('cumulTime'), {
  type: 'line',
  data: {
    labels: CUMUL_LABELS,
    datasets: [{ label: 'Cumulative time', data: CUMUL_DURATION,
      borderColor: '#22d3ee', backgroundColor: 'rgba(34,211,238,0.15)',
      fill: true, tension: 0.3, pointRadius: 2 }]
  },
  options: { ...baseOpts,
    scales: { ...baseOpts.scales,
      y: { ...baseOpts.scales.y,
        ticks: { ...baseOpts.scales.y.ticks, callback: v => formatDuration(v) } } },
    plugins: { ...baseOpts.plugins,
      tooltip: { callbacks: { label: ctx => ' ' + formatDuration(ctx.parsed.y) } } } }
});

// Time vs cost scatter
new Chart(document.getElementById('timeVsCost'), {
  type: 'scatter',
  data: {
    datasets: [{ label: 'Session', data: SCATTER_DATA,
      backgroundColor: '#34d399', pointRadius: 5, pointHoverRadius: 7 }]
  },
  options: { ...baseOpts,
    scales: { ...baseOpts.scales,
      x: { ...baseOpts.scales.x, type: 'linear', min: 0,
        ticks: { ...baseOpts.scales.x.ticks, callback: v => formatDuration(v) },
        title: { display: true, text: 'Duration', color: TEXT, font: { size: 10 } } },
      y: { ...baseOpts.scales.y,
        ticks: { ...baseOpts.scales.y.ticks, callback: v => '$' + v.toFixed(2) },
        title: { display: true, text: 'Cost (USD)', color: TEXT, font: { size: 10 } } } },
    plugins: { ...baseOpts.plugins,
      tooltip: { callbacks: {
        label: ctx => {
          const d = ctx.raw;
          return ` ${d.label}: ${formatDuration(d.x)} / $${d.y.toFixed(4)}`;
        }
      } } } }
});

// Tokens per minute scatter
new Chart(document.getElementById('tokensPerMin'), {
  type: 'scatter',
  data: {
    datasets: [{ label: 'Session', data: TPM_DATA,
      backgroundColor: '#818cf8', pointRadius: 5, pointHoverRadius: 7 }]
  },
  options: { ...baseOpts,
    scales: { ...baseOpts.scales,
      x: { ...baseOpts.scales.x, type: 'linear', min: 0,
        ticks: { ...baseOpts.scales.x.ticks, callback: v => formatDuration(v) },
        title: { display: true, text: 'Duration', color: TEXT, font: { size: 10 } } },
      y: { ...baseOpts.scales.y,
        title: { display: true, text: 'Output tokens / min', color: TEXT, font: { size: 10 } } } },
    plugins: { ...baseOpts.plugins,
      tooltip: { callbacks: {
        label: ctx => {
          const d = ctx.raw;
          return ` ${d.label}: ${formatDuration(d.x)} — ${d.y} tok/min`;
        }
      } } } }
});

// Session length distribution histogram
new Chart(document.getElementById('durationDist'), {
  type: 'bar',
  data: {
    labels: DUR_HIST_LABELS,
    datasets: [{ label: 'Sessions', data: DUR_HIST_VALUES,
      backgroundColor: '#34d399', borderRadius: 4 }]
  },
  options: { ...baseOpts,
    plugins: { ...baseOpts.plugins, legend: { display: false } },
    scales: { ...baseOpts.scales,
      y: { ...baseOpts.scales.y, ticks: { ...baseOpts.scales.y.ticks, stepSize: 1 } } } }
});

// Total vs key prompts per day
new Chart(document.getElementById('promptsVsTotal'), {
  type: 'bar',
  data: {
    labels: ALL_PROMPT_DATES,
    datasets: [
      { label: 'Total prompts', data: TOTAL_MSGS_BY_DATE,
         backgroundColor: 'rgba(148,163,184,0.35)', borderRadius: 4 },
      { label: 'Trivial prompts', data: TRIVIAL_BY_DATE,
         backgroundColor: '#34d399', borderRadius: 4 },
      { label: 'Key prompts', data: KEY_PROMPTS_BY_DATE,
         backgroundColor: '#a78bfa', borderRadius: 4 }
    ]
  },
  options: baseOpts
});

// Efficiency % per day
new Chart(document.getElementById('promptEfficiency'), {
  type: 'line',
  data: {
    labels: ALL_PROMPT_DATES,
    datasets: [{ label: 'Efficiency (%)', data: EFFICIENCY_BY_DATE,
      borderColor: '#f59e0b', backgroundColor: 'rgba(245,158,11,0.15)',
      fill: true, tension: 0.3, pointRadius: 3, spanGaps: true }]
  },
  options: { ...baseOpts, plugins: { ...baseOpts.plugins,
    tooltip: { callbacks: { label: ctx => ' ' + ctx.parsed.y + '%' } } },
    scales: { ...baseOpts.scales,
      y: { ...baseOpts.scales.y, min: 0, max: 100,
            ticks: { ...baseOpts.scales.y.ticks, callback: v => v + '%' } } } }
});

// Category doughnut
new Chart(document.getElementById('promptDonut'), {
  type: 'doughnut',
  data: {
    labels: DONUT_LABELS,
    datasets: [{ data: DONUT_VALUES, backgroundColor: DONUT_COLORS,
      borderWidth: 2, borderColor: '#1e2330' }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: true,
    plugins: {
      legend: { position: 'right', labels: { color: TEXT, boxWidth: 12, font: { size: 11 } } }
    }
  }
});

// Category stacked per day
new Chart(document.getElementById('promptStack'), {
  type: 'bar',
  data: {
    labels: PROMPT_DATES,
    datasets: PROMPT_CAT_DATASETS
  },
  options: { ...baseOpts,
    scales: {
      x: { ...baseOpts.scales.x, stacked: true },
      y: { ...baseOpts.scales.y, stacked: true }
    }
  }
});
</script>
</body>
</html>
